variables:
    GIT_DEPTH: 0

build.windows.msvc:
    stage: build
    tags:
        - windows
        - vulkan
        - amd64
    
    # Preparation
    before_script:
        - cmake --version
        - cmake -E capabilities
    
    # Process
    script:
        # Building

        # CMake - Debug
        - cmake -S . -B build/Debug -A x64 -D CMAKE_BUILD_TYPE=Debug
        - cmake --build build/Debug -t Game --clean-first

        # CMake - Profile
        #- cmake -S . -B build/Profile -A x64 -D CMAKE_BUILD_TYPE=Profile
        #- cmake --build build/Profile -t Game --clean-first

        # CMake - Release
        #- cmake -S . -B build/Release -A x64 -D CMAKE_BUILD_TYPE=Release
        #- cmake --build build/Release -t Game --clean-first

        # Linking Resources

        #- rm -rf dist/Debug/resources
        #- if (Test-Path ".\dist\Debug\resources") { Remove-Item ".\dist\Debug\resources" -Recurse -Force -Confirm:$False }
        #- rm -rf dist/Profile/resources
        #- if (Test-Path ".\dist\Profile\resources") { Remove-Item ".\dist\Profile\resources" -Recurse -Force -Confirm:$False }
        #- rm -rf dist/Release/resources
        #- if (Test-Path ".\dist\Release\resources") { Remove-Item ".\dist\Release\resources" -Recurse -Force -Confirm:$False }
        #- ln -sfrn resources dist/Debug/resources
        #- New-Item -ItemType Junction -Path ".\dist\Debug\resources" -Target ".\resources"
        #- ln -sfrn resources dist/Profile/resources
        #- New-Item -ItemType Junction -Path ".\dist\Profile\resources" -Target ".\resources"
        #- ln -sfrn resources dist/Release/resources
        #- New-Item -ItemType Junction -Path ".\dist\Release\resources" -Target ".\resources"
    
    artifacts:
        name: Heliogrim-Win-MSVC-$CI_COMMIT_REF_NAME
        paths:
            - dist/Debug/
            #- dist/Release/
            #- dist/Profile/
        expire_in: 15min

build.linux.gcc:
    stage: build
    tags:
        - linux
        - gcc11
        - vulkan
        - amd64
    
    # Preparation
    before_script:
        - cmake --version
        - cmake -E capabilities
    
    # Process
    script:
        # Building

        # CMake - Debug
        - cmake -S . -B build/Debug -A x64 -D CMAKE_C_COMPILER=/usr/bin/gcc -D CMAKE_CXX_COMPILER=/usr/bin/g++ -D CMAKE_BUILD_TYPE=Debug
        - cmake --build build/Debug -t Game --clean-first

        # CMake - Profile
        #- cmake -S . -B build/Profile -A x64 -D CMAKE_C_COMPILER=/usr/bin/gcc -D CMAKE_CXX_COMPILER=/usr/bin/g++ -D CMAKE_BUILD_TYPE=Profile
        #- cmake --build build/Profile -t Game --clean-first

        # CMake - Release
        #- cmake -S . -B build/Release -A x64 -D CMAKE_C_COMPILER=/usr/bin/gcc -D CMAKE_CXX_COMPILER=/usr/bin/g++ -D CMAKE_BUILD_TYPE=Release
        #- cmake --build build/Release -t Game --clean-first

        # Linking Resources
    
    artifacts:
        name: Heliogrim-Unix-GCC-$CI_COMMIT_REF_NAME
        paths:
            - dist/Debug/
            #- dist/Release/
            #- dist/Profile/
        expire_in: 15min

build.linux.clang:
    stage: build
    tags:
        - linux
        - clang13
        - vulkan
        - amd64
    
    # Preparation
    before_script:
        - cmake --version
        - cmake -E capabilities
    
    # Process
    script:
        # Building

        # CMake - Debug
        - cmake -S . -B build/Debug -A x64 -D CMAKE_C_COMPILER=/usr/bin/clang -D CMAKE_CXX_COMPILER=/usr/bin/clang++ -D CMAKE_BUILD_TYPE=Debug
        - cmake --build build/Debug -t Game --clean-first

        # CMake - Profile
        #- cmake -S . -B build/Profile -A x64 -D CMAKE_C_COMPILER=/usr/bin/clang -D CMAKE_CXX_COMPILER=/usr/bin/clang++ -D CMAKE_BUILD_TYPE=Profile
        #- cmake --build build/Profile -t Game --clean-first

        # CMake - Release
        #- cmake -S . -B build/Release -A x64 -D CMAKE_C_COMPILER=/usr/bin/clang -D CMAKE_CXX_COMPILER=/usr/bin/clang++ -D CMAKE_BUILD_TYPE=Release
        #- cmake --build build/Release -t Game --clean-first

        # Linking Resources
    
    artifacts:
        name: Heliogrim-Unix-Clang-$CI_COMMIT_REF_NAME
        paths:
            - dist/Debug/
            #- dist/Release/
            #- dist/Profile/
        expire_in: 15min

#test:
#    stage: test
#    script:
#        - echo "Test"

#deploy:
#    stage: deploy
#    script:
#        - echo "Deploy"
